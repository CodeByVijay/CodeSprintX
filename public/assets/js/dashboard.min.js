document.addEventListener('DOMContentLoaded',function(){const sidebar=document.querySelector('.sidebar');const sidebarToggle=document.getElementById('sidebar-toggle');const mobileSidebarToggle=document.getElementById('mobile-sidebar-toggle');const sidebarOverlay=document.getElementById('sidebar-overlay');const profileButton=document.getElementById('profile-button');const profileDropdown=document.getElementById('profile-dropdown');const sidebarLinks=sidebar?sidebar.querySelectorAll('a'):[];checkFontAwesome();initResponsiveTables();initResponsiveLayout();const isTouchDevice=('ontouchstart' in window)||(navigator.maxTouchPoints>0);if(isTouchDevice){enableTouchOptimizations()}
if(profileButton&&profileDropdown){profileButton.addEventListener('click',function(e){e.stopPropagation();profileDropdown.classList.toggle('hidden');const isExpanded=!profileDropdown.classList.contains('hidden');profileButton.setAttribute('aria-expanded',isExpanded)});document.addEventListener('click',function(e){if(!profileButton.contains(e.target)&&!profileDropdown.contains(e.target)){profileDropdown.classList.add('hidden');profileButton.setAttribute('aria-expanded','false')}});document.addEventListener('keydown',function(e){if(e.key==='Escape'&&!profileDropdown.classList.contains('hidden')){profileDropdown.classList.add('hidden');profileButton.setAttribute('aria-expanded','false')}})}
const tooltips=document.querySelectorAll('[data-tooltip]');if(tooltips.length>0){tooltips.forEach(tooltip=>{tooltip.addEventListener('mouseenter',function(){const tooltipText=this.getAttribute('data-tooltip');const tooltipEl=document.createElement('div');tooltipEl.className='tooltip absolute bg-gray-800 text-white text-xs rounded py-1 px-2 z-50';tooltipEl.innerHTML=tooltipText;document.body.appendChild(tooltipEl);const rect=this.getBoundingClientRect();tooltipEl.style.top=rect.bottom+5+'px';tooltipEl.style.left=rect.left+(rect.width/2)-(tooltipEl.offsetWidth/2)+'px'});tooltip.addEventListener('mouseleave',function(){const tooltips=document.querySelectorAll('.tooltip');tooltips.forEach(t=>t.remove())})})}
function initResponsiveTables(){const tables=document.querySelectorAll('.responsive-table-card');tables.forEach(table=>{if(window.innerWidth<=640){const headerCells=table.querySelectorAll('thead th');const headers=Array.from(headerCells).map(th=>th.textContent.trim());const dataCells=table.querySelectorAll('tbody td');dataCells.forEach((cell,index)=>{if(!cell.hasAttribute('data-label')){const headerIndex=index%headers.length;cell.setAttribute('data-label',headers[headerIndex])}})}})}
function checkFontAwesome(){const span=document.createElement('span');span.className='fa';span.style.display='none';document.body.appendChild(span);const isFontAwesomeLoaded=window.getComputedStyle(span).getPropertyValue('font-family').includes('Font');document.body.removeChild(span);if(!isFontAwesomeLoaded){console.warn('Font Awesome not loaded properly, attempting to reload');const link=document.createElement('link');link.rel='stylesheet';link.href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css';document.head.appendChild(link)}}
function enableTouchOptimizations(){if(sidebar){const sidebarItems=sidebar.querySelectorAll('a');sidebarItems.forEach(item=>{item.style.paddingTop='0.75rem';item.style.paddingBottom='0.75rem'});let touchStartX=0;let touchEndX=0;sidebar.addEventListener('touchstart',function(e){touchStartX=e.changedTouches[0].screenX},{passive:!0});sidebar.addEventListener('touchend',function(e){touchEndX=e.changedTouches[0].screenX;handleSwipe()},{passive:!0});function handleSwipe(){if(touchStartX-touchEndX>50&&window.innerWidth<768){sidebar.classList.remove('expanded');if(sidebarOverlay){sidebarOverlay.classList.remove('active')}}}}
const buttons=document.querySelectorAll('button, .btn, [role="button"]');buttons.forEach(button=>{if(!button.classList.contains('touch-optimized')){button.classList.add('touch-optimized');button.style.minHeight='44px'}})}
function initResponsiveLayout(){if(/iPhone|iPod|iPad/.test(navigator.userAgent)){const vh=window.innerHeight*0.01;document.documentElement.style.setProperty('--vh',`${vh}px`);window.addEventListener('resize',()=>{const vh=window.innerHeight*0.01;document.documentElement.style.setProperty('--vh',`${vh}px`)})}
const touchTargets=document.querySelectorAll('a, button, input, select, [role="button"]');touchTargets.forEach(target=>{if(!target.classList.contains('touch-target-size')&&!target.closest('.sidebar')&&!target.closest('.header')){target.classList.add('touch-target-size')}});const metaViewport=document.querySelector('meta[name="viewport"]');if(metaViewport&&/iPhone|iPad|iPod/.test(navigator.userAgent)){metaViewport.content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0'}
window.addEventListener('orientationchange',function(){setTimeout(()=>{const vh=window.innerHeight*0.01;document.documentElement.style.setProperty('--vh',`${vh}px`)},200)})}})
